temp.time<-NULL
temp.pimmune<-NULL
temp.pimmune.pk<-NULL
temp.nc<-NULL
ncurves<-10
a<-1:(8*ncurves)
a<-as.character(a)
set.seed(123)
temp.pk<-NULL
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/0/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t20_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("0",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("0",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/1/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t20_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("0",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("0",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/4/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t215_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("15",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("15",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/5/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t215_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("15",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("15",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/8/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t230_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("30",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[2*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("30",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/9/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t230_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("30",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[3*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("30",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/12/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t245_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("45",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[3*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("45",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC1/13/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t245_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc21.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("45",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[3*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("45",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
dt.Prev<-data.frame("Prevalence"=temp.prev,"Days"=temp.time,"IntroductionTime"=temp.t2, "VaccinationCoverage"=temp.pimmune, "Pathogen"=temp.path, "TempC"=temp.nc)
dt.Prev$Pathogen<-factor(dt.Prev$Pathogen, levels = c("Path1","Path2"))
dt.Prev$IntroductionTime<-factor(dt.Prev$IntroductionTime, levels = c("0","15","30","45"))
dt.Prev$VaccinationCoverage<-factor(dt.Prev$VaccinationCoverage, levels = c("0","0.4"))
dt.1<-dt.Prev[which(dt.Prev$TempC==1),]
dt.2<-dt.Prev[which(dt.Prev$TempC==2),]
dt.3<-dt.Prev[which(dt.Prev$TempC==3),]
dt.4<-dt.Prev[which(dt.Prev$TempC==4),]
dt.5<-dt.Prev[which(dt.Prev$TempC==5),]
dt.6<-dt.Prev[which(dt.Prev$TempC==6),]
dt.7<-dt.Prev[which(dt.Prev$TempC==7),]
dt.8<-dt.Prev[which(dt.Prev$TempC==8),]
dt.9<-dt.Prev[which(dt.Prev$TempC==9),]
dt.10<-dt.Prev[which(dt.Prev$TempC==10),]
library(dplyr)
vl.dt<-data.frame(IntroductionTime=rep(c("0","15","30","45"),2),z=c(0,13,26,39,0,20,40,60),VaccinationCoverage=c("0","0","0","0","0.4","0.4","0.4","0.4"))
aa2<-ggplot(data = dt.Prev, aes(x=Days,y=Prevalence, col=Pathogen))+geom_line(data=dt.1)+geom_line(data = dt.2)+geom_line(data = dt.3)+geom_line(data = dt.4)+geom_line(data = dt.5)+geom_line(data = dt.6)+geom_line(data = dt.7)+geom_line(data = dt.8)+geom_line(data = dt.9)+geom_line(data = dt.10)+scale_color_manual(values = c("#FFDB6D","#00AFBB"),labels=c("COVID-19","FLU"))+geom_vline(aes(xintercept=z),vl.dt, lty=2)+ theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Prevalence"))+xlab("Days")+facet_grid(IntroductionTime ~ VaccinationCoverage,  scales = "fixed", labeller = labeller(VaccinationCoverage=c("0"= "Vacc.coverage=0%","0.4"= "Vacc.coverage=40%"), IntroductionTime=c("0"="Beginning","15"="Ascending","30"="Peak","45"="Descending")))+labs(colour="Disease")
dt.Peak<-data.frame("PeakCases"=temp.pk,"IntroductionTime"=temp.t2.pk, "VaccinationCoverage"=temp.pimmune.pk, "Pathogen"=temp.path.pk)
dt.Peak$Pathogen<-factor(dt.Peak$Pathogen, levels = c("Path1","Path2"))
dt.Peak$IntroductionTime<-factor(dt.Peak$IntroductionTime, levels = c("0","15","30","45"))
dt.Peak$VaccinationCoverage<-factor(dt.Peak$VaccinationCoverage, levels = c("0","0.4"))
aa3<-ggplot(data = dt.Peak, aes(x=IntroductionTime,y=PeakCases, fill=Pathogen))+geom_violin()+scale_fill_manual(values = c("#FFDB6D","#00AFBB"),labels=c("COVID-19","FLU"))+stat_summary(fun.y=mean, geom="point", shape=15, size=3, color="navyblue", fill="black", aes(group=Pathogen),position=position_dodge(.9))+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Cases at Peak"))+xlab("Introduction time (FLU) - Epidemic progression (COVID-19)")+facet_grid( ~ VaccinationCoverage,  scales = "fixed", labeller = labeller(VaccinationCoverage=c("0"= "Vacc.coverage=0%","0.4"= "Vacc.coverage=40%")))+scale_x_discrete(labels=c("Beginning","Ascending " ,"Peak", "Descending"))+labs(fill="Disease")
aa4<-ggplot(data = dt.FigBIs, aes(x=IntroductionTime,y=FinalSize/2500, fill=Pathogen))+geom_violin()+scale_fill_manual(values = c("#FFDB6D","#00AFBB"),labels=c("COVID-19","FLU"))+stat_summary(fun.y=mean, geom="point", shape=15, size=3, color="navyblue", fill="black", aes(group=Pathogen),position=position_dodge(.9))+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Attack Rate"))+xlab("Introduction time (FLU) - Epidemic progression (COVID-19)")+facet_grid( ~ VaccinationCoverage,  scales = "fixed", labeller = labeller(VaccinationCoverage=c("0"= "Vacc.coverage=0%","0.4"= "Vacc.coverage=40%")))+scale_x_discrete(labels=c("Beginning","Ascending " ,"Peak", "Descending"))+labs(fill="Disease")
#ggarrange(aa2,aa3,ncol = 1,labels = c("A","B"),legend = "top")
ggarrange(aa2,
ggarrange(aa4,aa3,ncol = 2,labels = c("B","C"),common.legend = TRUE),
nrow=2,
labels = "A")
plot(aa1)
# BC 0.25 ----
temp.path<-NULL
temp.path.pk<-NULL
temp.t2<-NULL
temp.t2.pk<-NULL
temp.prev<-NULL
temp.time<-NULL
temp.pimmune<-NULL
temp.pimmune.pk<-NULL
temp.nc<-NULL
ncurves<-10
a<-1:(8*ncurves)
a<-as.character(a)
set.seed(123)
temp.pk<-NULL
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/0/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t20_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("0",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("0",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/1/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t20_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("0",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("0",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/4/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t215_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("15",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("15",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/5/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t215_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("15",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("15",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/8/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t230_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("30",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[2*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("30",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/9/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t230_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("30",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[3*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("30",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/12/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t245_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("45",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[3*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("45",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_final/COVFLUBC025/13/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t245_sigma12_0.05_sigma21_0.05_alpha10.5_alpha20.33_rho10.69_rho20.67_lli11_lli21_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc20.25.RData")
for (i in 1:ncurves){
epi.det<-epi.outbreak[[sample(1:length(epi.outbreak),1)]]$epi.details
temp.time<-c(temp.time,epi.det$Days,epi.det$Days)
temp.prev<-c(temp.prev,epi.det$Prevalence1,epi.det$Prevalence2)
temp.t2<-c(temp.t2, rep("45",2*length(epi.det$Days)))
temp.path<-c(temp.path,c(rep("Path1",length(epi.det$Days)),rep("Path2",length(epi.det$Days))))
temp.pimmune<-c(temp.pimmune, rep("0.4",2*length(epi.det$Days)))
#temp.nc<-c(temp.nc, rep(a[3*ncurves+i],2*length(epi.det$Days)))
temp.nc<-c(temp.nc, rep(a[i],2*length(epi.det$Days)))
}
#temp.pk<-NULL
for (i in 1:length(epi.outbreak)){
temp.pk<-c(temp.pk, epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence1,epi.outbreak[[i]]$PeakPrevalence$PeakPrevalence2)
temp.path.pk<-c(temp.path.pk,rep(c("Path1","Path2")))
temp.t2.pk<-c(temp.t2.pk, rep("45",2))
temp.pimmune.pk<-c(temp.pimmune.pk, rep("0.4",2))
}
quantile(temp.pk,0.025)
quantile(temp.pk,0.975)
dt.Prev<-data.frame("Prevalence"=temp.prev,"Days"=temp.time,"IntroductionTime"=temp.t2, "VaccinationCoverage"=temp.pimmune, "Pathogen"=temp.path, "TempC"=temp.nc)
dt.Prev$Pathogen<-factor(dt.Prev$Pathogen, levels = c("Path1","Path2"))
dt.Prev$IntroductionTime<-factor(dt.Prev$IntroductionTime, levels = c("0","15","30","45"))
dt.Prev$VaccinationCoverage<-factor(dt.Prev$VaccinationCoverage, levels = c("0","0.4"))
dt.1<-dt.Prev[which(dt.Prev$TempC==1),]
dt.2<-dt.Prev[which(dt.Prev$TempC==2),]
dt.3<-dt.Prev[which(dt.Prev$TempC==3),]
dt.4<-dt.Prev[which(dt.Prev$TempC==4),]
dt.5<-dt.Prev[which(dt.Prev$TempC==5),]
dt.6<-dt.Prev[which(dt.Prev$TempC==6),]
dt.7<-dt.Prev[which(dt.Prev$TempC==7),]
dt.8<-dt.Prev[which(dt.Prev$TempC==8),]
dt.9<-dt.Prev[which(dt.Prev$TempC==9),]
dt.10<-dt.Prev[which(dt.Prev$TempC==10),]
library(dplyr)
vl.dt<-data.frame(IntroductionTime=rep(c("0","15","30","45"),2),z=c(0,13,26,39,0,20,40,60),VaccinationCoverage=c("0","0","0","0","0.4","0.4","0.4","0.4"))
aa2025<-ggplot(data = dt.Prev, aes(x=Days,y=Prevalence, col=Pathogen))+geom_line(data=dt.1)+geom_line(data = dt.2)+geom_line(data = dt.3)+geom_line(data = dt.4)+geom_line(data = dt.5)+geom_line(data = dt.6)+geom_line(data = dt.7)+geom_line(data = dt.8)+geom_line(data = dt.9)+geom_line(data = dt.10)+scale_color_manual(values = c("#FFDB6D","#00AFBB"),labels=c("COVID-19","FLU"))+geom_vline(aes(xintercept=z),vl.dt, lty=2)+ theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Prevalence"))+xlab("Days")+facet_grid(IntroductionTime ~ VaccinationCoverage,  scales = "fixed", labeller = labeller(VaccinationCoverage=c("0"= "Vacc.coverage=0%","0.4"= "Vacc.coverage=40%"), IntroductionTime=c("0"="Beginning","15"="Ascending","30"="Peak","45"="Descending")))+labs(colour="Disease")
dt.Peak<-data.frame("PeakCases"=temp.pk,"IntroductionTime"=temp.t2.pk, "VaccinationCoverage"=temp.pimmune.pk, "Pathogen"=temp.path.pk)
dt.Peak$Pathogen<-factor(dt.Peak$Pathogen, levels = c("Path1","Path2"))
dt.Peak$IntroductionTime<-factor(dt.Peak$IntroductionTime, levels = c("0","15","30","45"))
dt.Peak$VaccinationCoverage<-factor(dt.Peak$VaccinationCoverage, levels = c("0","0.4"))
aa3025<-ggplot(data = dt.Peak, aes(x=IntroductionTime,y=PeakCases, fill=Pathogen))+geom_violin()+scale_fill_manual(values = c("#FFDB6D","#00AFBB"),labels=c("COVID-19","FLU"))+stat_summary(fun.y=mean, geom="point", shape=15, size=3, color="navyblue", fill="black", aes(group=Pathogen),position=position_dodge(.9))+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Cases at Peak"))+xlab("Introduction time (FLU) - Epidemic progression (COVID-19)")+facet_grid( ~ VaccinationCoverage,  scales = "fixed", labeller = labeller(VaccinationCoverage=c("0"= "Vacc.coverage=0%","0.4"= "Vacc.coverage=40%")))+scale_x_discrete(labels=c("Beginning","Ascending " ,"Peak", "Descending"))+labs(fill="Disease")
dt.FigBIs025<-dt.Fig3A.STI[which(dt.Fig3A.STI$Compliance=="0.25"),]
aa4025<-ggplot(data = dt.FigBIs025, aes(x=IntroductionTime,y=FinalSize/2500, fill=Pathogen))+geom_violin()+scale_fill_manual(values = c("#FFDB6D","#00AFBB"),labels=c("COVID-19","FLU"))+stat_summary(fun.y=mean, geom="point", shape=15, size=3, color="navyblue", fill="black", aes(group=Pathogen),position=position_dodge(.9))+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Attack Rate"))+xlab("Introduction time (FLU) - Epidemic progression (COVID-19)")+facet_grid( ~ VaccinationCoverage,  scales = "fixed", labeller = labeller(VaccinationCoverage=c("0"= "Vacc.coverage=0%","0.4"= "Vacc.coverage=40%")))+scale_x_discrete(labels=c("Beginning","Ascending " ,"Peak", "Descending"))+labs(fill="Disease")
#ggarrange(aa2,aa3,ncol = 1,labels = c("A","B"),legend = "top")
ggarrange(aa2025,
ggarrange(aa4025,aa3025,ncol = 2,labels = c("B","C"),common.legend = TRUE),
nrow=2,
labels = "A")
1.4*0.3
1.4*0.6
