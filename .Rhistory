legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")
ggplot(data = df, aes(x=theta, y=Likelihood))+geom_line()+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")
8/10
ggplot(data = df, aes(x=theta, y=Likelihood))+geom_line()+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")++geom_hline(yintercept = 0.8,linetype="dotted")+geom_vline(xintercept = 0.31,linetype="dotted")
ggplot(data = df, aes(x=theta, y=Likelihood))+geom_line()+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")+geom_hline(yintercept = 0.8,linetype="dotted")+geom_vline(xintercept = 0.31,linetype="dotted")
ggplot(data = df, aes(x=theta, y=Likelihood))+geom_line()+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")+geom_hline(yintercept = 0.31,linetype="dotted")+geom_vline(xintercept = 0.8,linetype="dotted")
ggplot(data = df, aes(x=theta, y=Likelihood))+geom_line()+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")+geom_hline(yintercept = 0.3,linetype="dotted")+geom_vline(xintercept = 0.8,linetype="dotted")
ggplot(data = df, aes(x=theta, y=Likelihood))+geom_line()+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")+geom_hline(yintercept = 0.305,linetype="dotted")+geom_vline(xintercept = 0.8,linetype="dotted")
ggplot(data = df, aes(x=theta, y=Likelihood))+geom_line()+theme(
panel.background = element_rect(fill = "white",
colour = "gray",
size = 0.75, linetype = "solid"),
panel.grid.major = element_line(size = 0.25, linetype = 'solid',
colour = "gray"),
panel.grid.minor = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
legend.key.size = unit(1, "cm"),
legend.key.width = unit(1,"cm"),
legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "",
#legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Likelihood"))+xlab("Theta")+geom_hline(yintercept = 0.302,linetype="dotted")+geom_vline(xintercept = 0.8,linetype="dotted")
(0-50)*(14-55.4)
(25-50)*(38-55.4)
(75-50)*(76-55.4)
(100-50)*(95-55.4)
1980+515+435+2070
25*25
50^2
2500+2500+625+625
5000/6250
39.52847/6250
39.52847/sqrt(6250)
sqrt(6250)
39.52847/79.05694
55.4-0.8*50
15.4+0.8*25
15.4+0.8*50
15.4+0.8*75
15.4+0.8*100
74.84+96000*0.53+1.129*16-50*0.005-0.008*250
74.84+96*0.53+1.129*16-50*0.005-0.008*250
74.84+96000*0.053+1.129*16-50*0.005-0.008*250
74.84+0.053*96000
0.053*96000
0.053*96
74.84+96*0.053+1.129*16-50*0.005-0.008*0.250
74.84+0.053*96+1.129*16-0.005*50-0.008*250
-0.03/(sqrt(0.6*0.4/750))
install.packages("plotly")
library("plotly")
k<-rnorm(10, mean=5,sd=3)
k
install.packages("persDx")
k
x<-seq(-19.99,20,0.01)
y<-seq(0.01,40,0.01)
x<-seq(-19.99,20,0.01)
y<-seq(0.01,40,0.01)
z<-NULL
for (i in 1:length(x)){
z<-c(z,-5*log(y[i])-(1/2*y[i])*( (k[1]-x[i])^2+(k[2]-x[i])^2+(k[3]-x[i])^2+(k[4]-x[i])^2+(k[5]-x[i])^2+(k[6]-x[i])^2+(k[7]-x[i])^2+(k[8]-x[i])^2+(k[9]-x[i])^2+(k[10]-x[i])^2))
}
persp(x,y,z)
persp(x,y)
persp(x,y,x)
persp(z)
persp(x,y,z)
f <- function(x, y) { r<-(z,-5*log(y[i])-(1/2*y[i])*( (k[1]-x[i])^2+(k[2]-x[i])^2+(k[3]-x[i])^2+(k[4]-x[i])^2+(k[5]-x[i])^2+(k[6]-x[i])^2+(k[7]-x[i])^2+(k[8]-x[i])^2+(k[9]-x[i])^2+(k[10]-x[i])^2)) }
f <- function(x, y) { r<-(-5*log(y[i])-(1/2*y[i])*( (k[1]-x[i])^2+(k[2]-x[i])^2+(k[3]-x[i])^2+(k[4]-x[i])^2+(k[5]-x[i])^2+(k[6]-x[i])^2+(k[7]-x[i])^2+(k[8]-x[i])^2+(k[9]-x[i])^2+(k[10]-x[i])^2)) }
l<-outer(x,y,f)
x<-seq(-19.99,20,0.1)
y<-seq(0.01,40,0.1)
f <- function(x, y) { r<-(-5*log(y[i])-(1/2*y[i])*( (k[1]-x[i])^2+(k[2]-x[i])^2+(k[3]-x[i])^2+(k[4]-x[i])^2+(k[5]-x[i])^2+(k[6]-x[i])^2+(k[7]-x[i])^2+(k[8]-x[i])^2+(k[9]-x[i])^2+(k[10]-x[i])^2)) }
l<-outer(x,y,f)
x <- seq(-10, 10, length.out = 30)
y <- x
f <- function(x, y) { r <- sqrt(x^2+y^2); 10 * sin(r)/r }
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue",
ltheta = 120, shade = 0.75, ticktype = "detailed",
xlab = "X", ylab = "Y", zlab = "Sinc( r )"
) -> res
x <- seq(-10, 10, length.out = 30)
y <- x
f <- function(x, y) { r <- x^2+y^2; 10 * sin(r)/r }
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue",
ltheta = 120, shade = 0.75, ticktype = "detailed",
xlab = "X", ylab = "Y", zlab = "Sinc( r )"
) -> res
f <- function(x, y) { r <- x^2+y^2}
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue",
ltheta = 120, shade = 0.75, ticktype = "detailed",
xlab = "X", ylab = "Y", zlab = "Sinc( r )"
) -> res
f <- function(x, y) { r <- -x^2+y^2}
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
f <- function(x, y) { r <- -x^2-y^2}
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue",
ltheta = 120, shade = 0.75, ticktype = "detailed",
xlab = "X", ylab = "Y", zlab = "Sinc( r )"
) -> res
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
f <- function(x, y) { r <- -x^2-6*y}
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
f <- function(x, y) { r <- -x^2-6*y^4}
z <- outer(x, y, f)
z[is.na(z)] <- 1
op <- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue",
ltheta = 120, shade = 0.75, ticktype = "detailed",
xlab = "X", ylab = "Y", zlab = "Sinc( r )"
) -> res
10/(0.8*0.2)
1/62.5
1/sqrt(62.5)
0.13*1.96
0.8-0.25
0.8+0.25
x<-seq(-5,5,0.1)
plot(x,-x^2)
plot(x,-30*x^2, type = "l")
lines(x,x^2, col = 2)
lines(x,-x^2, col = 2)
plot(x,-30*x^2, type = "l")
lines(x,-x^2, col = 2)
plot(x,-5*x^2, type = "l")
lines(x,-x^2, col = 2)
x<-seq(-10,10,0.1)
plot(x,-5*x^2, type = "l")
lines(x,-x^2, col = 2)
hist(rnorm(10000, mean=5000, sd=300))
hist(rnorm(10000, mean=5000, sd=1000))
hist(rnorm(10000, mean=5000, sd=2000))
hist(rnorm(10000, mean=5000, sd=3000))
hist(rnorm(10000, mean=5000, sd=2000))
hist(rnorm(10000, mean=7000, sd=2000))
hist(rnorm(10000, mean=7000, sd=1000))
hist(rnorm(10000, mean=7000, sd=2000))
0.2/(0.5/sqrt(300))
(0.5/sqrt(300))
0.2/(0.5/sqrt(300))
0.2/0.03
0.2/0.0289
b<-c(138,117,113,134,118,128,125,126,119,119)
a<-c(131,110,104,119,124,123,120,131,87,111)
d<-b-a
d
mean(d)
sd(d)
7.7/(10.59/sqrt(10))
a
a[3]<-102
a[3]<-106
d<-b-a
d
mean(d)
sd(d)
a[3]<-104
a[2]<-112
a[9]<-95
d<-b-a
d
mean(d)
sd(d)
s<-sd(d)
6.7/(s/sqrt(10))
a[9]<-100
mean(d)
a[4]<-123
d<-b-a
mean(d)
s<-sd(d)
mean(d)/(s/sqrt(10))
a<-c(131,110,104,119,124,123,120,131,87,111)
a[10]<-123
m<-mean(d)
s<-sd(d)
m/(s/sqrt(10))
a<-c(131,110,104,119,124,123,120,131,87,111)
a[10]<-123
a<[9]<-115
a[9]<-115
m<-mean(d)
d<-b-a
m<-mean(d)
s<-sd(d)
m/(s/sqrt(10))
a<-c(131,110,104,119,124,123,120,131,87,111)
a[9]<-115
d<-b-a
m<-mean(d)
s<-sd(d)
m/(s/sqrt(10))
a<-c(131,110,104,119,124,123,120,131,87,111)
a[10]<-123
d<-b-a
d
m<-mean(d)
s<-sd(d)
m/(s/sqrt(10))
a[10]<-120
d<-b-a
s<-sd(d)
m<-mean(d)
m/(s/sqrt(10))
a
d
d
mean(d)
m<-mean(d)
sd(d)
s<-sd(d)
m/(s/sqrt(10))
a[7]<-121
d<-b-a
m<-mean(d)
s<-sd(d)
m/(s/sqrt(10))
a
a[1]<-129
m<-mean(d)
d<-b-a
s<-sd(d)
m<-mean(d)
m/(s/sqrt(10))
d
m
s
a[10]<-122
d<-b-a
m<-mean(d)
s<-sd(d)
m/(s/sqrt(10))
a[7]<-124
d<-b-a
m<-mean(d)
s<-sd(d)
m/(s/sqrt(10))
a
b
d<-b-a
d
m<-mean(d)
m
s<-sd(d)
s
m/(s/sqrt(10))
m/(11.29/sqrt(10))
1.833*11.29/sqrt(10)
2.262*11.29/sqrt(10)
3.25*11.29/sqrt(10)
17.440-0.018*335-3.238*2.77+0.811*15.5+2.926
qt(0.025,df=3, lower.tail = FALSE)
a<-c(138,117,113,134,118,128,125,126,119,119)
b<-c(129,110,104,119,124,123,124,131,87,122)
d<-a-b
d
mean(d)
sd(d)
6.4/(sd(d)/sqrt(n))
6.4/(sd(d)/sqrt(10))
############################################3
# Plot household size density
freq<-c(rep(1,163186),rep(2,151288),rep(3,72304),rep(4,60656),rep(5,22343),rep(6,6889),rep(7,2097))
hhsz.dens<-data.frame("Freq"=freq)
1.833*10.94/sqrt(10)
2.262*10.94/sqrt(10)
3.25*10.94/sqrt(10)
0.2/(sqrt(0.5*(0.5)/300))
5.928*27
-0.018/0.14
-0.018/sqrt(0.14)
0.018/0.014
4.68/sqrt(10)
4.68*sqrt(10)
mean(c(10,8.5,9,0,6.5,0,8.5,7.5))
4/13
0.3*1.5
2+1.75+3.5+2.5+2.5+2
0+1.5+0+0+2+2
4+4+2.5+3+2
4+4+2.5+3+2+3.5
3+3+3.5+1.5+0+2
9/13
1.5*0.7
1+3.5+2+3+4+1
2+3.5+2+1+1.5+2
5/13*1.5
2+0.5+1.5+1.5+3+1.5
2+2+3+3.5+3.5+4
0+2+3.5+3.5+3+3
3.5+2.5+2.5+4+2
3.5+2.5+2.5+4+2+3.5
2+2+1+
0
5/13
5/13*1.5
2+2+4+3+2+2.5
2+3.5+2.5+3.5+2+2
2+3.5+1.5+3.5+3+2
0+0+1+0.5+1.5+2
0+1+1+0.5+1.75+1
qnorm(0.975,mean=0,sd=1)
0+1.5+3+1.75+1
7.25+0.5+0.5
2+2+3.5+0.5+3+2.5
5/13*1.5
2+1.5+0.5+1+2+1.5
1+2+2.5+3.5+3+2.5
2+3.5+2+3.5+0.5+2
5/13*1.5
7/13*1.5
2+1.25+0+3.5+2.5+1.5
2+2.5+3+3+2.5+2.5
2+1.75+1+2+1+2
1.5+1+2
2+1.5+2+2+1+0
5/13*1.5
0.5+1+0+1+1.75
2/13*1.5
0.25+2+1.5+2+2
3+2.75+3+2+3.5+2
1+1.5+2+3+1.5
3.5+3.25+3.5+2+2+2
4/13*1.5
0.5+1+2+1.5+3+2
0+1+1+1+2+2
2+1+2+2+2+2
1.75+2+3.5+3+1.5+2
load("~/Desktop/SIM_MP/CTR/235/MP_Synth_nVertex2500_nNetw100XA_&_XS_R11.5_R21.5_qhqg8.27_t20_sigma12_1_sigma21_1_alpha11_alpha21_rho11_rho21_lli10_lli20_NetSynth_CtcRed0.25_PImm0_tSeed30_bc10.5_bc21.RData")
a<-epi.outbreak[[1]]
a$time.events
a$FinalSize
a<-epi.outbreak[[2]]
a$FinalSize
a<-epi.outbreak[[3]]
a$FinalSize
a<-epi.outbreak[[4]]
a$FinalSize
a<-epi.outbreak[[5]]
a$FinalSize
a<-epi.outbreak[[6]]
a$FinalSize
a<-epi.outbreak[[7]]
a$FinalSize
a<-epi.outbreak[[8]]
a$FinalSize
a<-epi.outbreak[[9]]
a$FinalSize
a<-epi.outbreak[[10]]
a$FinalSize
load("~/Desktop/SIM_MP/CTR/233/MP_Synth_nVertex2500_nNetw100XS_&_XS_R11.5_R21.5_qhqg8.27_t20_sigma12_1_sigma21_1_alpha11_alpha21_rho11_rho21_lli10_lli20_NetSynth_CtcRed1_PImm0_tSeed30_bc11_bc21.RData")
a<-epi.outbreak[[1]]
a$FinalSize
setwd("~/Documents/Work/PhD/Co-infection/Multi-phatogen")
