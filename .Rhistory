legend.background = element_rect(fill = "white"),
legend.key = element_rect(fill = "white", color = NA),
legend.text = element_text(size=14),
legend.position = "top",
legend.title = element_text(size=15, face = "bold"),
axis.text.x = element_text(size=14, angle = 45, vjust = 0.5, hjust = 0.5),
axis.title = element_text(size=15),
axis.text.y = element_text(size=14),
strip.text = element_text(size = 15)
)+ylab(("Cases at Peak"))+xlab("Introduction time (FLU) - Epidemic progression (COVID-19)")+facet_grid( ~ VaccinationCoverage,  scales = "fixed", labeller = labeller(VaccinationCoverage=c("0"= "Vacc.coverage=0%","0.4"= "Vacc.coverage=40%")))+scale_x_discrete(labels=c("Beginning","Ascending " ,"Peak", "Descending"))+labs(fill="Disease")
ggarrange(aa2,
ggarrange(aa1,aa3,ncol = 2,labels = c("B","C"),common.legend = TRUE),
nrow=2,
labels = "A")
# LONG-TERM interaction ----
# PLOTS (FLU-COVID-19) Het. eff #
# FLU-COVID - Introduction Time & compliance for FLU (R2 1.3) - COVID-19 (3.3)----
temp.path<-NULL
temp.bc<-NULL
temp.t2<-NULL
temp.fs<-NULL
temp.pimmune<-NULL
# bc.2 1
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_Final/COVFLUBC05LC/0/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t20_sigma12_1_sigma21_1_alpha10.5_alpha20.33_rho10.69_rho20.67_lli10.5_lli20.5_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
for (i in 1:length(epi.outbreak)){
temp.fs<-c(temp.fs,epi.outbreak[[i]]$FinalSize$FinalSize1,epi.outbreak[[i]]$FinalSize$FinalSize2)
}
temp.bc<-c(temp.bc,rep("1",2*length(epi.outbreak)))
temp.t2<-c(temp.t2, rep("0",2*length(epi.outbreak)))
temp.path<-c(temp.path,rep(c("Path1","Path2"),length(epi.outbreak)))
temp.pimmune<-c(temp.pimmune, rep("0",2*length(epi.outbreak)))
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_Final/COVFLUBC05LC/1/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t20_sigma12_1_sigma21_1_alpha10.5_alpha20.33_rho10.69_rho20.67_lli10.5_lli20.5_NetSynth_CtcRed0_PImm0.4_tSeed1000_bc11_bc21.RData")
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_Final/COVFLUBC05LC/2/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t245_sigma12_1_sigma21_1_alpha10.5_alpha20.33_rho10.69_rho20.67_lli10.5_lli20.5_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_Final/COVFLUBC05LC/3/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t245_sigma12_1_sigma21_1_alpha10.5_alpha20.33_rho10.69_rho20.67_lli10.5_lli20.5_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_Final/COVFLUBC05LC/3/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t236_sigma12_1_sigma21_1_alpha10.5_alpha20.33_rho10.69_rho20.67_lli10.5_lli20.5_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Sims_Final/COVFLUBC05LC/3/MP_Synth_nVertex2500_nNetw100COVID-19_&_FLU-A_R13.3_R21.3_qhqg8.27_t239_sigma12_1_sigma21_1_alpha10.5_alpha20.33_rho10.69_rho20.67_lli10.5_lli20.5_NetSynth_CtcRed0_PImm0_tSeed1000_bc11_bc21.RData")
1.014939*dgamma(t,shape = 3.2930139,scale = 0.9533298)
3 %% 5
3 %% 1
3 %% 100
103 %% 100
100 %% 100
1.014939*dgamma(t,shape = 3.2930139,scale = 0.9533298)
g<-function(t){
1.014939*dgamma(t,shape = 3.2930139,scale = 0.9533298)
}
t<-seq(0,8,0.01)
plot(t,g(t))
max(g(t))
load("~/Desktop/TP_Synth_nVertex2500_nNetw100_R1.3_ratioqhqg8.27_rho0.67_alpha0.33_pathogenFLU-A_cdec0_comp1.RData")
max(g(t))* inf.path.h
integrate(g,lower = 0,upper = 8)
integrate(g,lower = 0,upper = 2)
R<-1.3
ratio.hqhg<-8.27
rho<-0.67
alpha<-0.33
pathogen<-"FLU-A"
ctc.dec<-0
compl<-1
source("R_comp_netw.R")
setwd("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Multi-phatogen")
load("~/Library/CloudStorage/GoogleDrive-andrea.torneri@uhasselt.be/My Drive/Work/PhD/Co-infection/Multi-phatogen/HH_Networks_nVertex100_nNetw5.RData")
ratio_hhgl<-lambda.h/lambda.g*ratio.qhqg
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
source("R_comp_netw.R")
ratio_hhgl<-lambda.h/lambda.g*ratio.qhqg
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
ratio.qhqg<-8.27
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
lambda.h<-3.34 #average number of daily within household (Mossong et al. 2008 - Belgium)
lambda.g<-8.29 #average number of daily contacts at a community level (Mossong et al. 2008 - Belgium)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
ratio_hhgl<-lambda.h/lambda.g*ratio.qhqg
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
library(ergm)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
t2<-1000
sigma12<-1
sigma21<-1
prop.immune<-0
nSeeds.1<-5
nSeeds.2<-5
nSeeds.2<-1
rho.1<-0.67
rho.2<-0.67
alpha.as.1<-alpha.as.2<-alpha
lli.1<-lli.2<-1
pathogen.1<-"FLU-A"
pathogen.2<-"FLU-A"
contact.reduction<-ctc.dec
t.stop<-365
t.seed<-1000
bc.1<-compl
bc.2<-compl
reinf<-1
typeIC<-1
het.vac<-1
#load data
inf.path.h<-trs.prms.1$beta.h
inf.path.g<-trs.prms.1$q.g
inf.path.1.h<-inf.path.h
inf.path.1.g<-inf.path.g
inf.path.2.g<-0.001
inf.path.2.h<-0.001
#Mean number of daily contact at a global level (Using SOCRATES 15/02/2022 )
lambda.g<-8.29
#Compute the reproduction number related to the selected network.
source("function.multipathogen.new.R")
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
mean(hh1)
hist(hh)
ctc.dec
ctc.dec<-1
bc.1<-ctc.dec
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
ctc.dec
bc.1<-1
ratio_hhgl<-lambda.h/lambda.g*ratio.qhqg
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
R<-0.9
#load data
inf.path.h<-trs.prms.1$beta.h
inf.path.g<-trs.prms.1$q.g
inf.path.1.h<-inf.path.h
inf.path.1.g<-inf.path.g
bc.1
bc.2
R
compl
bc.1
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
mean(hh1)
ctc.dec
contact.reduction
rho
bc.1
compl
contact.reduction
contact.reduction<-1
ctc.dec
#Compute the reproduction number related to the selected network.
source("function.multipathogen.new.R")
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
mean(hh1)
compl
compl<-0.2
bc.1<-0.2
ratio_hhgl<-lambda.h/lambda.g*ratio.qhqg
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
#load data
inf.path.h<-trs.prms.1$beta.h
inf.path.g<-trs.prms.1$q.g
inf.path.1.h<-inf.path.h
inf.path.1.g<-inf.path.g
#Mean number of daily contact at a global level (Using SOCRATES 15/02/2022 )
lambda.g<-8.29
#Compute the reproduction number related to the selected network.
source("function.multipathogen.new.R")
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
hist(hh)
compl
bc.1
ctc.dec
contact.reduction
nSeeds.1<-1
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
#Compute the reproduction number related to the selected network.
source("function.multipathogen.new.R")
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
hist
hist(hh)
R<-1.1
ratio_hhgl<-lambda.h/lambda.g*ratio.qhqg
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
#load data
inf.path.h<-trs.prms.1$beta.h
inf.path.g<-trs.prms.1$q.g
inf.path.1.h<-inf.path.h
inf.path.1.g<-inf.path.g
#Mean number of daily contact at a global level (Using SOCRATES 15/02/2022 )
lambda.g<-8.29
#Compute the reproduction number related to the selected network.
source("function.multipathogen.new.R")
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
mean(hh1)
hist
hist(hh1)
hist(hh)
R
R<-1.15
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
#load data
inf.path.h<-trs.prms.1$beta.h
inf.path.g<-trs.prms.1$q.g
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
hist
hist(hh)
inf.path.1.h<-inf.path.h
inf.path.1.g<-inf.path.g
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
hist(hh)
bc.1
compl
ctc.dec
ctc.dec<-0
contact.reduction<-0
R<-0.9
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
#load data
inf.path.h<-trs.prms.1$beta.h
inf.path.g<-trs.prms.1$q.g
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
inf.path.1.h<-inf.path.h
inf.path.1.g<-inf.path.g
#Compute the reproduction number related to the selected network.
source("function.multipathogen.new.R")
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
hist(hh)
alpha
alpha.as.1
alpha.as.1<-alpha<-1
R.rif<-R
nSim<-200
tol<-0.01*R.rif #tolerance is 0.5% of the target value
nSeed<-3082021
set.seed(nSeed)
trs.prms.1<-R0.comp.Inf.new(ratio_hhgl=ratio.qhqg, HH.network = HH.networks, nSim = nSim, tol=tol,R.rif = R.rif, prob.asym=(1-rho),asymp.rel.inf=alpha,lambda.g = lambda.g,pathogen=pathogen,ctc.dec=ctc.dec,compl=compl)
#load data
inf.path.h<-trs.prms.1$beta.h
inf.path.g<-trs.prms.1$q.g
inf.path.1.h<-inf.path.h
inf.path.1.g<-inf.path.g
#Compute the reproduction number related to the selected network.
source("function.multipathogen.new.R")
nSim<-100
epi.outbreak<-list()
nSeed<-1062021
set.seed(nSeed)
nm<-paste("t2_",t2, "_sigma12_",sigma12,"_sigma21_",sigma21,"_qh1_",inf.path.1.h,"_qg1_",inf.path.1.g,"_qh2_",inf.path.2.h,"_qg2_",inf.path.2.g, "_rho1_",rho.1,"_rho2_",rho.2,"_alpha1_",alpha.as.1,"_alpha2_",alpha.as.2,"_Path1",pathogen.1,"_Path2",pathogen.2,"_lli.1",lli.1,"_lli2",lli.2, sep = "")
print(nm)
for (i in 1:nSim){
print(i)
temp.HH.netw<-HH.networks[[sample(1:length(HH.networks),1)]]
epi.outbreak[[i]]<-sim.multipathogen(HH.network = temp.HH.netw, t2=t2, lambda.g = lambda.g, sigma12 = sigma12, sigma21 = sigma21, prop.immune = prop.immune, nSeeds.1 = nSeeds.1, nSeeds.2 = nSeeds.2, rho.1 = rho.1, rho.2 = rho.2, inf.path.1.h = inf.path.1.h,inf.path.1.g = inf.path.1.g, inf.path.2.h = inf.path.2.h,inf.path.2.g = inf.path.2.g, alpha.as.1=alpha.as.1,alpha.as.2=alpha.as.2, lli.1=lli.1,lli.2=lli.2, pathogen.1=pathogen.1, pathogen.2=pathogen.2, contact.reduction=contact.reduction, t.stop=t.stop, t.seed=t.seed, bc.1=bc.1, bc.2=bc.2, reinf=reinf, typeIC=typeIC, het.vac=het.vac)
}
hh<-NULL
hh1<-NULL
for (i in 1:100){
hh<-c(hh,epi.outbreak[[i]]$FinalSize$FinalSize1)
if (epi.outbreak[[i]]$FinalSize$FinalSize1>250){
hh1<-c(hh1,epi.outbreak[[i]]$FinalSize$FinalSize1)
}
}
mean(hh)
hist(hh)
